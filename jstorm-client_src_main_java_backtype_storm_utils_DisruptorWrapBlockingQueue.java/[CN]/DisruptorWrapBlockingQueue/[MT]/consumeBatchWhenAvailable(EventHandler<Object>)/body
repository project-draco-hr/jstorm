{
  boolean handled=consumeBatchToCursor(0,handler);
  ;
  if (handled == false) {
    try {
      Object object=queue.take();
      handler.onEvent(object,0,false);
    }
 catch (    InterruptedException e) {
      LOG.warn("Occur interrupt error");
    }
catch (    Exception e) {
      throw new RuntimeException(e);
    }
  }
}
