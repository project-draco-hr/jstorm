{
  List<TaskMetricInfo> taskMetricList=new ArrayList<TaskMetricInfo>();
  String monitorTaskDirPath=Cluster.monitor_taskdir_path(topologyId);
  List<String> taskList=cluster_state.get_children(monitorTaskDirPath,false);
  for (  String taskId : taskList) {
    Object taskMetric=Cluster.maybe_deserialize(cluster_state.get_data(Cluster.monitor_task_path(topologyId,taskId),false));
    if (taskMetric != null) {
      taskMetricList.add((TaskMetricInfo)taskMetric);
    }
 else {
      LOG.warn("get_task_metric_list failed, topoId: " + topologyId + " taskId:"+ taskId);
    }
  }
  return taskMetricList;
}
