{
  List<String> task_ids=clusterState.task_storms();
  List<String> heartbeat_ids=clusterState.heartbeat_storms();
  List<String> error_ids=clusterState.task_error_storms();
  List<String> assignment_ids=clusterState.assignments(null);
  List<String> monitor_ids=clusterState.monitors();
  String master_stormdist_root=StormConfig.masterStormdistRoot(nimbusData.getConf());
  List<String> code_ids=PathUtils.read_dir_contents(master_stormdist_root);
  Set<String> to_cleanup_ids=new HashSet<String>();
  if (task_ids != null) {
    to_cleanup_ids.addAll(task_ids);
  }
  if (heartbeat_ids != null) {
    to_cleanup_ids.addAll(heartbeat_ids);
  }
  if (error_ids != null) {
    to_cleanup_ids.addAll(error_ids);
  }
  if (assignment_ids != null) {
    to_cleanup_ids.addAll(assignment_ids);
  }
  if (monitor_ids != null) {
    to_cleanup_ids.addAll(monitor_ids);
  }
  if (code_ids != null) {
    to_cleanup_ids.addAll(code_ids);
  }
  if (active_topologys != null) {
    to_cleanup_ids.removeAll(active_topologys);
  }
  return to_cleanup_ids;
}
