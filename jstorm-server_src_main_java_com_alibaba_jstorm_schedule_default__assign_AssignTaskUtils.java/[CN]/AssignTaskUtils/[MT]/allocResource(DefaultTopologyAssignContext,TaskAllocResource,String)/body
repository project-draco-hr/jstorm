{
  String diskSlot=null;
  Map<String,SupervisorInfo> cluster=defaultContext.getCluster();
  SupervisorInfo supervisorInfo=cluster.get(supervisorId);
  if (supervisorInfo == null) {
    StringBuilder sb=new StringBuilder();
    sb.append("No supervisor of " + supervisorId + ",");
    sb.append("\n\n");
    sb.append(defaultContext.toDetailString());
    LOG.warn(sb.toString());
    throw new FailedAssignTopologyException(sb.toString());
  }
  supervisorInfo.getCpuPool().alloc(taskAlloc.getCpuSlotNum(),defaultContext);
  supervisorInfo.getMemPool().alloc(taskAlloc.getMemSlotNum(),defaultContext);
  if (taskAlloc.isAllocDisk()) {
    diskSlot=supervisorInfo.getDiskPool().alloc(defaultContext);
  }
  ResourceAssignment taskResource=new ResourceAssignment();
  taskResource.setSupervisorId(supervisorId);
  taskResource.setDiskSlot(diskSlot);
  taskResource.setCpuSlotNum(taskAlloc.getCpuSlotNum());
  taskResource.setMemSlotNum(taskAlloc.getMemSlotNum());
  taskResource.setPort(null);
  return taskResource;
}
