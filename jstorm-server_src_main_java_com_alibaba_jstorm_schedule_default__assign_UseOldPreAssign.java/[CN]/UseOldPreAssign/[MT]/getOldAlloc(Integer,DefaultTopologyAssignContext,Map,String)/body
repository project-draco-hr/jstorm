{
  Map stormConf=defaultContext.getStormConf();
  if (ConfigExtension.isUseOldAssignment(stormConf) == false && ConfigExtension.isUseOldAssignment(componentMap) == false) {
    return null;
  }
  Assignment oldAssign=defaultContext.getOldAssignment();
  if (oldAssign == null) {
    LOG.info("Try USE_OLD_ASSIGNMENT, but no old Assignment");
    return null;
  }
  ResourceAssignment oldAssignment=oldAssign.getTaskToResource().get(task);
  if (oldAssignment == null) {
    LOG.warn(componentName + " no old assignment of task " + task+ ","+ defaultContext);
    return null;
  }
  TaskAllocResource taskAlloc=AssignTaskUtils.getTaskAlloc(task,defaultContext,componentMap,componentName);
  if (taskAlloc.allocEqual(oldAssignment) == false) {
    LOG.info(componentName + " of " + task+ " allocation has changed, old assignment can't be used ");
    LOG.info(" new Assignment " + taskAlloc);
    LOG.info(" old Assignment  " + oldAssignment);
    return null;
  }
  LOG.info("Use old assignment " + oldAssignment);
  return oldAssignment;
}
