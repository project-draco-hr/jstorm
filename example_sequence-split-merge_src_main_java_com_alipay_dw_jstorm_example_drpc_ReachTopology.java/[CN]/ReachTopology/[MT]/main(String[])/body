{
  LinearDRPCTopologyBuilder builder=construct();
  Config conf=new Config();
  conf.setNumWorkers(6);
  if (args.length == 0) {
    StormSubmitter.submitTopology(TOPOLOGY_NAME,conf,builder.createRemoteTopology());
  }
 else {
    conf.setMaxTaskParallelism(3);
    LocalDRPC drpc=new LocalDRPC();
    LocalCluster cluster=new LocalCluster();
    cluster.submitTopology(TOPOLOGY_NAME,conf,builder.createLocalTopology(drpc));
    JStormUtils.sleepMs(50000);
    String[] urlsToTry=new String[]{"foo.com/blog/1","engineering.twitter.com/blog/5","notaurl.com"};
    for (    String url : urlsToTry) {
      System.out.println("Reach of " + url + ": "+ drpc.execute(TOPOLOGY_NAME,url));
    }
    cluster.shutdown();
    drpc.shutdown();
  }
}
