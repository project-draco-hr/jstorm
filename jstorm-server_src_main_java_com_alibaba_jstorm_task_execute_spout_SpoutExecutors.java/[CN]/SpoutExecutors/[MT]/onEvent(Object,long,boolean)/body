{
  ackerTimer.start();
  try {
    if (event == null) {
      return;
    }
    Runnable runnable=null;
    if (event instanceof Tuple) {
      Tuple tuple=(Tuple)event;
      Object id=tuple.getValue(0);
      Object obj=pending.remove((Long)id);
      if (obj == null) {
        LOG.debug("Pending map no entry:" + id + ", pending size:"+ pending.size());
        return;
      }
      TupleInfo tupleInfo=(TupleInfo)obj;
      String stream_id=tuple.getSourceStreamId();
      if (stream_id.equals(Acker.ACKER_ACK_STREAM_ID)) {
        runnable=new AckSpoutMsg(spout,tupleInfo,task_stats,isDebug);
      }
 else       if (stream_id.equals(Acker.ACKER_FAIL_STREAM_ID)) {
        runnable=new FailSpoutMsg(spout,tupleInfo,task_stats,isDebug);
      }
 else {
        LOG.warn("Receive one unknow source Tuple " + idStr);
        return;
      }
      task_stats.recv_tuple(tuple.getSourceComponent(),tuple.getSourceStreamId());
    }
 else     if (event instanceof TimeTick.Tick) {
      Map<Long,TupleInfo> timeoutMap=pending.rotate();
      for (      java.util.Map.Entry<Long,TupleInfo> entry : timeoutMap.entrySet()) {
        TupleInfo tupleInfo=entry.getValue();
        FailSpoutMsg fail=new FailSpoutMsg(spout,(TupleInfo)tupleInfo,task_stats,isDebug);
        fail.run();
      }
      return;
    }
 else     if (event instanceof IAckMsg) {
      runnable=(Runnable)event;
    }
 else     if (event instanceof Runnable) {
      runnable=(Runnable)event;
    }
 else {
      LOG.warn("Receive one unknow event " + idStr);
      return;
    }
    runnable.run();
  }
 catch (  Exception e) {
    if (taskStatus.isShutdown() == false) {
      LOG.info("Unknow excpetion ",e);
      report_error.report(e);
    }
  }
 finally {
    ackerTimer.stop();
  }
}
