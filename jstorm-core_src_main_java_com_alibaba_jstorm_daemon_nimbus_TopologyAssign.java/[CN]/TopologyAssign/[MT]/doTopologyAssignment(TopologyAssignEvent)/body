{
  Assignment assignment=null;
  try {
    assignment=mkAssignment(event);
    if (!(event.isScratch()))     setTopologyStatus(event);
  }
 catch (  Throwable e) {
    LOG.error("Failed to assign topology " + event.getTopologyId(),e);
    event.fail(e.getMessage());
    return false;
  }
  if (assignment != null)   backupAssignment(assignment,event);
  event.done();
  return true;
}
