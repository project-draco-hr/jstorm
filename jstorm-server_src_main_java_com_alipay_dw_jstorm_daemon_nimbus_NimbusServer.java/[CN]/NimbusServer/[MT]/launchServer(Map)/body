{
  LOG.info("Begin to start nimbus with conf " + conf);
  StormConfig.validate_distributed_mode(conf);
  initShutdownHook();
  data=createNimbusData(conf);
  NimbusUtils.cleanupCorruptTopologies(data);
  initTopologyAssign();
  initTopologyStatus();
  initMonitor(conf);
  initCleaner(conf);
  serviceHandler=new ServiceHandler(data);
  initThrift(conf);
}
