{
  try {
    TopologyMetricsRunnable.Event event=queue.take();
    if (event instanceof Remove) {
      handleRemoveEvent((Remove)event);
      return;
    }
 else     if (event instanceof Update) {
      handleUpdateEvent((Update)event);
      return;
    }
 else     if (event instanceof Upload) {
      handleUploadEvent((Upload)event);
      return;
    }
 else {
      LOG.error("Unknow event type");
      return;
    }
  }
 catch (  Exception e) {
    if (isShutdown.get() == false) {
      LOG.error(e.getMessage(),e);
    }
  }
}
