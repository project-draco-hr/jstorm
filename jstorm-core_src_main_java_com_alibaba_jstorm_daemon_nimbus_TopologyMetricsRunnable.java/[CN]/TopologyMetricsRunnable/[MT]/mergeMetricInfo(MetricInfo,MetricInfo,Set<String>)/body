{
  if (to == null) {
    to=MetricThrift.mkMetricInfo();
  }
  if (from.get_baseMetric() == null) {
    LOG.warn("No base Metric ");
    return to;
  }
  for (  String tag : tags) {
    MetricWindow fromMetric=from.get_baseMetric().get(tag);
    Map<String,MetricWindow> toMetricMap=to.get_baseMetric();
    if (toMetricMap == null) {
      toMetricMap=new HashMap<String,MetricWindow>();
      to.set_baseMetric(toMetricMap);
    }
    MetricWindow toMetric=toMetricMap.get(tag);
    toMetric=MetricThrift.mergeMetricWindow(fromMetric,toMetric);
    toMetricMap.put(tag,toMetric);
  }
  return to;
}
