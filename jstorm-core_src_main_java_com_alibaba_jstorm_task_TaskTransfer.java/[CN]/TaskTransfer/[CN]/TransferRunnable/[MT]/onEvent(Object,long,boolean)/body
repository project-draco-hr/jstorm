{
  if (event == null) {
    return;
  }
  long start=System.currentTimeMillis();
  try {
    TupleExt tuple=(TupleExt)event;
    int taskid=tuple.getTargetTaskId();
    byte[] tupleMessage=serializer.serialize(tuple);
    TaskMessage taskMessage=new TaskMessage(taskid,tupleMessage);
    IConnection conn=getConnection(taskid);
    if (conn != null) {
      conn.send(taskMessage);
    }
  }
  finally {
    long end=System.currentTimeMillis();
    timer.update(end - start);
  }
}
