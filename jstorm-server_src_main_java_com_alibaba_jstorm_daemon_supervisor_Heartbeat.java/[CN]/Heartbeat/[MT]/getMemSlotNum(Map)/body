{
  Integer object=JStormServerConfig.getSupervisorMemSlotNum(conf);
  if (object != null && JStormUtils.parseInt(object) > 0) {
    return JStormUtils.parseInt(object);
  }
  Long physicalMemSize=JStormUtils.getPhysicMemorySize();
  if (physicalMemSize == null) {
    throw new RuntimeException("Failed to get system physical memory, please set by manual");
  }
  LOG.info("Get system memory size :" + physicalMemSize);
  long availablePhyMemSize=0;
  if (physicalMemSize <= MEM_THREADHOLD) {
    availablePhyMemSize=MEM_THREADHOLD;
  }
 else {
    availablePhyMemSize=Math.min((long)(physicalMemSize * 0.8),physicalMemSize - 4 * JStormUtils.SIZE_1_G);
  }
  long memSlotSize=ConfigExtension.getMemSlotSize(conf);
  int ret=(int)(availablePhyMemSize / memSlotSize);
  if (ret <= 0) {
    ret=1;
  }
  return ret;
}
