{
  int spout_Parallelism_hint=conf.get(TOPOLOGY_SPOUT_PARALLELISM_HINT) == null ? 1 : (Integer)conf.get(TOPOLOGY_SPOUT_PARALLELISM_HINT);
  int bolt_Parallelism_hint=conf.get(TOPOLOGY_BOLT_PARALLELISM_HINT) == null ? 1 : (Integer)conf.get(TOPOLOGY_BOLT_PARALLELISM_HINT);
  builder.setSpout(SequenceTopologyDef.SEQUENCE_SPOUT_NAME,new SequenceSpout(),1);
  builder.setBolt(SequenceTopologyDef.SPLIT_BOLT_NAME,new SplitRecord(),2).shuffleGrouping(SequenceTopologyDef.SEQUENCE_SPOUT_NAME);
  builder.setBolt(SequenceTopologyDef.TRADE_BOLT_NAME,new PairCount(),1).shuffleGrouping(SequenceTopologyDef.SPLIT_BOLT_NAME,SequenceTopologyDef.TRADE_STREAM_ID);
  builder.setBolt(SequenceTopologyDef.CUSTOMER_BOLT_NAME,new PairCount(),1).shuffleGrouping(SequenceTopologyDef.SPLIT_BOLT_NAME,SequenceTopologyDef.CUSTOMER_STREAM_ID);
  builder.setBolt(SequenceTopologyDef.MERGE_BOLT_NAME,new MergeRecord(),2).fieldsGrouping(SequenceTopologyDef.TRADE_BOLT_NAME,new Fields("ID")).fieldsGrouping(SequenceTopologyDef.CUSTOMER_BOLT_NAME,new Fields("ID"));
  builder.setBolt(SequenceTopologyDef.TOTAL_BOLT_NAME,new TotalCount(),2).noneGrouping(SequenceTopologyDef.MERGE_BOLT_NAME);
  conf.put(Config.TOPOLOGY_DEBUG,false);
  Config.setNumAckers(conf,1);
  conf.put(Config.TOPOLOGY_WORKERS,20);
}
