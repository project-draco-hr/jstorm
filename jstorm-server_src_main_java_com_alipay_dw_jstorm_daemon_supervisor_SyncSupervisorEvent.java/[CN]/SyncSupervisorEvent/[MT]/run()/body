{
  LOG.debug("Synchronizing supervisor");
  try {
    RunnableCallback syncCallback=new EventManagerZkPusher(this,syncSupEventManager);
    Map<String,Assignment> assignments=Cluster.get_all_assignment(stormClusterState,syncCallback);
    LOG.debug("Get all assignments " + assignments);
    List<String> downloadedTopologyIds=StormConfig.get_supervisor_toplogy_list(conf);
    LOG.debug("Downloaded storm ids: " + downloadedTopologyIds);
    Map<Integer,LocalAssignment> localAssignment=getLocalAssign(stormClusterState,supervisorId,assignments);
    try {
      LOG.debug("Writing local assignment " + localAssignment);
      localState.put(Common.LS_LOCAL_ASSIGNMENTS,localAssignment);
    }
 catch (    IOException e) {
      LOG.error("put LS_LOCAL_ASSIGNMENTS " + localAssignment + " of localState failed");
      throw e;
    }
    Map<String,String> topologyCodes=getTopologyCodeLocations(assignments);
    downloadTopology(topologyCodes,downloadedTopologyIds);
    removeUselessTopology(topologyCodes,downloadedTopologyIds);
    processEventManager.add(syncProcesses);
  }
 catch (  Exception e) {
    LOG.error("Failed to Sync Supervisor",e);
  }
}
