{
  PartitionConsumer partitionConsumer=partitionConsumerMap.get(partition);
  partitionConsumers.remove(partitionConsumer);
  partitionConsumerMap.remove(partition);
  MessageConsumer simpleConsumer=kafkaConsumerMap.get(partition.getBroker());
  if (simpleConsumer != null) {
    simpleConsumer.removePartition(partition);
    if (simpleConsumer.getPartitions().isEmpty()) {
      simpleConsumer.close();
    }
  }
}
