{
  if (!Utils.isValidConf(conf))   throw new RuntimeException("Topology conf is not json-serializable");
  try {
    state.getNimbus().submitTopologyWithOpts(topologyName,null,JSONValue.toJSONString(conf),topology,submitOpts);
  }
 catch (  TopologyAssignException e) {
    LOG.error("Failed to submit topology " + topologyName,e);
  }
catch (  TException e) {
    LOG.error("Failed to submit topology " + topologyName,e);
  }
}
