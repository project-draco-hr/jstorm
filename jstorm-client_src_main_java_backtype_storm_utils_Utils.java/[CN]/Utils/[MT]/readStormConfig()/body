{
  Map ret=readDefaultConfig();
  String confFile=System.getProperty("storm.conf.file");
  Map storm;
  if (StringUtils.isBlank(confFile) == true) {
    storm=findAndReadConfigFile("storm.yaml",false);
  }
 else {
    storm=loadDefinedConf(confFile);
  }
  ret.putAll(storm);
  ret.putAll(readCommandLineOpts());
  replaceLocalDir(ret);
  return ret;
}
