{
synchronized (lock) {
    for (    Entry<Integer,BatchTuple> entry : batchMap.entrySet()) {
      int taskId=entry.getKey();
      BatchTuple batch=entry.getValue();
      if (batch != null && batch.currBatchSize() > 0) {
        pushToQueue(taskId,batch);
      }
    }
  }
}
