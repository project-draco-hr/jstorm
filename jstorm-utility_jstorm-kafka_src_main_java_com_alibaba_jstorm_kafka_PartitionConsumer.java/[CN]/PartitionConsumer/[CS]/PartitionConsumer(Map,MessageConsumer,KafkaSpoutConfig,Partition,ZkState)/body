{
  this.stormConf=conf;
  this.config=config;
  this.partition=partition;
  this.consumer=consumer;
  this.zkState=offsetState;
  Long jsonOffset=null;
  try {
    Map<Object,Object> json=offsetState.readJSON(zkPath());
    if (json != null) {
      jsonOffset=(Long)json.get("offset");
    }
  }
 catch (  Throwable e) {
    LOG.warn("Error reading and/or parsing at ZkNode: " + zkPath(),e);
  }
  if (config.fromBeginning) {
    emittingOffset=-1;
  }
 else {
    if (jsonOffset == null) {
      lastCommittedOffset=-1;
    }
 else {
      lastCommittedOffset=jsonOffset;
    }
    emittingOffset=lastCommittedOffset;
  }
}
