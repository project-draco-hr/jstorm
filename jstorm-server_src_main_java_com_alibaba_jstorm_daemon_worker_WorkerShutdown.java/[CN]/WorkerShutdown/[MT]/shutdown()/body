{
  active.set(false);
  for (  ShutdownableDameon task : shutdowntasks) {
    task.shutdown();
  }
  for (  WorkerSlot k : nodeportSocket.keySet()) {
    IConnection value=nodeportSocket.get(k);
    value.close();
  }
  virtualPortShutdown.shutdown();
  context.term();
  for (  AsyncLoopThread t : threads) {
    t.interrupt();
    try {
      t.join();
    }
 catch (    InterruptedException e) {
      LOG.error("join thread",e);
    }
  }
  try {
    zkCluster.disconnect();
    cluster_state.close();
  }
 catch (  Exception e) {
    LOG.info("Shutdown error,",e);
  }
}
