{
  Integer currtime=TimeUtils.current_time_secs();
  Event<Task> taskHbEvent=event;
  int taskId=taskHbEvent.getTaskId();
  String idStr=" " + topology_id + ":"+ taskId+ " ";
  try {
    TaskHeartbeat hb=new TaskHeartbeat(currtime,uptime.uptime());
    zkCluster.task_heartbeat(topology_id,taskId,hb);
    LOG.info("update task hearbeat ts " + currtime + " for"+ idStr);
    Task task=taskHbEvent.getEventValue();
    Long timeStamp=taskAssignTsMap.get(taskId);
    if (timeStamp != null) {
      if (timeStamp < task.getWorkerAssignmentTs() && task.getWorkerAssignmentType().equals(AssignmentType.Assign)) {
        LOG.info("Start to update the task data for task-" + taskId);
        task.updateTaskData();
        taskAssignTsMap.put(taskId,task.getWorkerAssignmentTs());
      }
    }
  }
 catch (  Exception e) {
    String errMsg="Failed to update heartbeat to ZK " + idStr + "\n";
    LOG.error(errMsg,e);
  }
}
