{
  this.conf=conf;
  this.downloaders=downloaders;
  this.uploaders=uploaders;
  this.submittedCount=new AtomicInteger(0);
  this.stormClusterState=Cluster.mk_storm_cluster_state(conf);
  this.taskHeartbeatsCache=new ConcurrentHashMap<String,Map<Integer,TkHbCacheTime>>();
  this.scheduExec=Executors.newScheduledThreadPool(SCHEDULE_THREAD_NUM);
  this.statusTransition=new StatusTransition(this);
  this.startTime=TimeUtils.current_time_secs();
  this.inimubs=inimbus;
  this.scheduler=NimbusUtils.mkScheduler(conf,inimbus);
  this.groupToTopology=new HashMap<String,Map<String,Map<ThriftResourceType,Integer>>>();
  this.groupToResource=new ConcurrentHashMap<String,Map<ThriftResourceType,Integer>>();
  this.groupToUsedResource=new ConcurrentHashMap<String,Map<ThriftResourceType,Integer>>();
  this.flushGroupFileLock=new ReentrantLock();
  String groupCfg=ConfigExtension.getGroupFilePath(conf);
  if (StringUtils.isBlank(groupCfg))   groupMode=false;
 else   groupMode=true;
  localMode=StormConfig.local_mode(conf);
}
