{
  MetricInfo workerMetricInfo=MetricThrift.mkMetricInfo();
  Map<String,Metric> workerMetricMap=workerMetrics.getMetrics();
  for (  Entry<String,Metric> entry : workerMetricMap.entrySet()) {
    String name=entry.getKey();
    Map<Integer,Double> snapshot=entry.getValue().getSnapshot();
    MetricThrift.insert(workerMetricInfo,name,snapshot);
  }
  System.out.println(Utils.toPrettyJsonString(workerMetricInfo));
  return workerMetricInfo;
}
