{
  Set<String> usedNodes=new HashSet<String>();
  for (  Entry<Integer,NodePort> entry : taskNodePort.entrySet()) {
    usedNodes.add(entry.getValue().getNode());
  }
  Map<String,String> allNodeHost=new HashMap<String,String>();
  if (existingAssignment != null) {
    allNodeHost=existingAssignment.getNodeHost();
  }
  Map<String,String> nodeHost=SupervisorInfo.getNodeHost(supervisorMap);
  if (nodeHost != null) {
    allNodeHost.putAll(nodeHost);
  }
  Map<String,String> ret=new HashMap<String,String>();
  for (  String supervisorId : usedNodes) {
    if (allNodeHost.containsKey(supervisorId)) {
      ret.put(supervisorId,allNodeHost.get(supervisorId));
    }
 else {
      LOG.warn("Node " + supervisorId + " doesn't in the supervisor list");
    }
  }
  return ret;
}
