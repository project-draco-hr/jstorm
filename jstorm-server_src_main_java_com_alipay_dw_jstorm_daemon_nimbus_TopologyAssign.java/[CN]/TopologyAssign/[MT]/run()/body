{
  LOG.info("TopologyAssign thread has been started");
  runFlag=true;
  while (runFlag) {
    TopologyAssignEvent event=queue.poll();
    if (event == null) {
      try {
        Thread.sleep(100);
      }
 catch (      InterruptedException e) {
      }
      continue;
    }
    boolean isSuccess=doTopologyAssignment(event);
    if (isSuccess == false) {
    }
 else {
      try {
        cleanupDisappearedTopology();
      }
 catch (      Exception e) {
        LOG.error("Failed to do cleanup disappear topology ",e);
        continue;
      }
    }
  }
}
