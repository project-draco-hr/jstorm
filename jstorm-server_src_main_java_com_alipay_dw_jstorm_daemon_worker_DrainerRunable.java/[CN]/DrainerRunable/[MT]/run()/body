{
  try {
    while (true) {
      TransferData felem=transferQueue.take();
      if (felem == null) {
        return;
      }
      long before=System.currentTimeMillis();
      int taskId=felem.getTaskid();
      byte[] tuple=felem.getData();
      NodePort nodePort=taskNodeport.get(taskId);
      if (nodePort == null) {
        String errormsg="can`t not found IConnection";
        LOG.warn("DrainerRunable warn",new Exception(errormsg));
        continue;
      }
      ISendConnection conn=nodeportSocket.get(nodePort);
      if (conn == null) {
        String errormsg="can`t not found nodePort";
        LOG.warn("DrainerRunable warn",new Exception(errormsg));
        continue;
      }
      if (conn.isClosed() == true) {
        continue;
      }
      conn.send(felem.getData());
      long after=System.currentTimeMillis();
      drainerCounter.count(after - before);
    }
  }
 catch (  Exception e) {
    LOG.error("DrainerRunable send error",e);
  }
}
