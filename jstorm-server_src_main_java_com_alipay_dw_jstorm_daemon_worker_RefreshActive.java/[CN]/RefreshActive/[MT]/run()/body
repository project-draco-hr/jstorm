{
  if (active.get() == false) {
    return;
  }
  try {
    StatusType newTopologyStatus=StatusType.activate;
    StormBase base=zkCluster.storm_base(topologyId,this);
    if (base == null) {
      LOG.warn("Failed to get StromBase from ZK of " + topologyId);
      newTopologyStatus=StatusType.killed;
    }
 else {
      newTopologyStatus=base.getStatus().getStatusType();
    }
    StatusType oldTopologyStatus=workerData.getTopologyStatus();
    if (newTopologyStatus.equals(oldTopologyStatus)) {
      return;
    }
    LOG.info("Old TopologyStatus:" + oldTopologyStatus + ", new TopologyStatus:"+ newTopologyStatus);
    workerData.setTopologyStatus(newTopologyStatus);
    if (newTopologyStatus.equals(StatusType.active)) {
      List<TaskShutdownDameon> tasks=workerData.getShutdownTasks();
      for (      TaskShutdownDameon task : tasks) {
        task.active();
      }
    }
 else {
      List<TaskShutdownDameon> tasks=workerData.getShutdownTasks();
      for (      TaskShutdownDameon task : tasks) {
        task.deactive();
      }
    }
  }
 catch (  Exception e) {
    LOG.error("Failed to get topology from ZK ",e);
    return;
  }
}
