{
  int num_workers=assignment.getWorkers().size();
  int num_tasks=0;
  for (  ResourceWorkerSlot worker : assignment.getWorkers()) {
    num_tasks=num_tasks + worker.getTasks().size();
  }
  long currentTimeSecs=System.currentTimeMillis() / 1000;
  String errorInfo;
  if (lastErrTimeStamp == null)   errorInfo="N";
 else {
    if ((currentTimeSecs - Long.valueOf(lastErrTimeStamp)) < 1800)     errorInfo="Y";
 else     errorInfo="N";
  }
  TopologySummary ret=new TopologySummary(topologyId,topologyName,status,uptime_secs,num_tasks,num_workers,errorInfo);
  return ret;
}
