{
  if (inimbus != null && inimbus.getForcedScheduler() != null)   return inimbus.getForcedScheduler();
 else   if (conf.get(Config.STORM_SCHEDULER) != null) {
    IScheduler result=null;
    try {
      result=(IScheduler)Class.forName(Config.STORM_SCHEDULER).newInstance();
    }
 catch (    Exception e) {
      LOG.error(Config.STORM_SCHEDULER + " : Scheduler initialize error!");
      throw new RuntimeException("Fail to new Scheduler");
    }
    return result;
  }
 else {
    return new DefaultScheduler();
  }
}
