{
  Map<Integer,LocalAssignment> portTasks=new HashMap<Integer,LocalAssignment>();
  StormBase stormBase=stormClusterState.storm_base(topologyId,null);
  if (stormBase == null) {
    LOG.error("Failed to get StormBase of " + topologyId);
    return portTasks;
  }
  Set<ResourceWorkerSlot> workers=assignmenInfo.getWorkers();
  if (workers == null) {
    LOG.error("No worker of assignement's " + assignmenInfo);
    return portTasks;
  }
  for (  ResourceWorkerSlot worker : workers) {
    if (!supervisorId.equals(worker.getNodeId()))     continue;
    portTasks.put(worker.getPort(),new LocalAssignment(topologyId,worker.getTasks(),stormBase.getStormName(),worker.getMemSize(),worker.getCpu(),worker.getJvm()));
  }
  return portTasks;
}
