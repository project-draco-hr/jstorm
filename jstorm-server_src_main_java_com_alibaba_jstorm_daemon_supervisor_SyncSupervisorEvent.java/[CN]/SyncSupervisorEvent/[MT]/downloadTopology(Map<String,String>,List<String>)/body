{
  for (  Entry<String,String> entry : topologyCodes.entrySet()) {
    String topologyId=entry.getKey();
    String masterCodeDir=entry.getValue();
    if (!downloadedTopologyIds.contains(topologyId)) {
      LOG.info("Downloading code for storm id " + topologyId + " from "+ masterCodeDir);
      try {
        downloadStormCode(conf,topologyId,masterCodeDir);
      }
 catch (      IOException e) {
        LOG.error(e + " downloadStormCode failed " + "topologyId:"+ topologyId+ "masterCodeDir:"+ masterCodeDir);
        throw e;
      }
catch (      TException e) {
        LOG.error(e + " downloadStormCode failed " + "topologyId:"+ topologyId+ "masterCodeDir:"+ masterCodeDir);
        throw e;
      }
      LOG.info("Finished downloading code for storm id " + topologyId + " from "+ masterCodeDir);
    }
  }
}
