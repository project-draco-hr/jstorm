{
  String name=metricInfo.getName();
  Metric metric=metricInfo.getMetric();
  if (metric instanceof QueueGauge) {
    float queueRatio=(((QueueGauge)metric).getValue()) * 100;
    double value=JStormUtils.formatDoubleDecPoint2((double)queueRatio);
    gaugeData.put(name,value);
  }
 else   if ((metric instanceof Gauge<?>) || (metric instanceof TimerRatio)) {
    Double value=JStormUtils.convertToDouble(((Gauge)metric).getValue());
    if (value == null) {
      LOG.warn("gauge value is null or unknow type.");
    }
 else {
      value=JStormUtils.formatDoubleDecPoint4(value);
      gaugeData.put(name,value);
    }
  }
 else   if (metric instanceof Timer) {
    Snapshot snapshot=((Timer)metric).getSnapshot();
    Double value=JStormUtils.formatDoubleDecPoint4((snapshot.getMean()) / 1000000);
    timerData.put(name,value);
  }
 else   if (metric instanceof Counter) {
    Long value=((Counter)metric).getCount();
    counterData.put(name,value.doubleValue());
  }
 else   if (metric instanceof Meter) {
    Double value=JStormUtils.formatDoubleDecPoint4(((Meter)metric).getMeanRate());
    meterData.put(name,value);
  }
 else   if (metric instanceof Histogram) {
    Snapshot snapshot=((Histogram)metric).getSnapshot();
    Double value=JStormUtils.formatDoubleDecPoint4(snapshot.getMean());
    histogramData.put(name,value);
  }
 else {
    LOG.warn("Unknown metric type, name:" + name);
  }
}
