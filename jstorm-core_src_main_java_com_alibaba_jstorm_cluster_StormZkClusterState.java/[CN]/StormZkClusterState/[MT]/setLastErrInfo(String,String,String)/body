{
  String lastErrTopoPath=Cluster.lasterror_path(topologyId);
  Map<Integer,String> lastErrInfo=null;
  try {
    lastErrInfo=(Map<Integer,String>)getObject(lastErrTopoPath,false);
  }
 catch (  Exception e) {
    LOG.error("Failed to get last error time. Remove the corrupt node for " + topologyId,e);
    remove_lastErr_time(topologyId);
    lastErrInfo=null;
  }
  if (lastErrInfo == null)   lastErrInfo=new HashMap<Integer,String>();
  if (error.indexOf(QueueGauge.QUEUE_IS_FULL) != -1)   lastErrInfo.put(JStormUtils.MIN_1 * 3,timeStamp);
 else   if (error.indexOf(TASK_IS_DEAD) != -1)   lastErrInfo.put(JStormUtils.DAY_1 * 3,timeStamp);
 else   lastErrInfo.put(JStormUtils.MIN_30,timeStamp);
  setObject(lastErrTopoPath,lastErrInfo);
}
