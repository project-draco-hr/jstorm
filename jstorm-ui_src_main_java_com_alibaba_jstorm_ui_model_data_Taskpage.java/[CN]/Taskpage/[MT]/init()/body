{
  NimbusClient client=null;
  try {
    Map conf=Utils.readStormConfig();
    client=UIUtils.getNimbusClient(conf,clusterName);
    TopologyInfo summ=client.getClient().getTopologyInfo(topologyid);
    List<TaskSummary> ts=summ.get_tasks();
    if (ts == null) {
      throw new NotAliveException("No TaskSummary");
    }
    TaskSummary t=null;
    if (ts != null) {
      int tssize=ts.size();
      for (int i=0; i < tssize; i++) {
        if (ts.get(i).get_task_id() == Integer.parseInt(taskid)) {
          t=ts.get(i);
        }
      }
    }
    tsumms=taskSummaryTable(t,summ);
    esumms=taskErrorTable(t);
  }
 catch (  TException e) {
    LOG.error(e.getCause(),e);
    throw e;
  }
catch (  NotAliveException e) {
    LOG.error(e.getCause(),e);
    throw e;
  }
catch (  Exception e) {
    LOG.error(e.getCause(),e);
    throw new TException(e);
  }
 finally {
    if (client != null) {
      client.close();
    }
  }
}
