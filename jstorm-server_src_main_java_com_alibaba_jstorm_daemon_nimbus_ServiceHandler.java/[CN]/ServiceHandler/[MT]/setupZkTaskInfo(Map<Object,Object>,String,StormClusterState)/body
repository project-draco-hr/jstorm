{
  stormClusterState.setup_heartbeats(topologyId);
  Map<Integer,TaskInfo> taskToComponetId=mkTaskComponentAssignments(conf,topologyId);
  if (taskToComponetId == null || taskToComponetId.size() == 0) {
    throw new InvalidTopologyException("Failed to generate TaskIDs map");
  }
  for (  Entry<Integer,TaskInfo> entry : taskToComponetId.entrySet()) {
    stormClusterState.set_task(topologyId,entry.getKey(),entry.getValue());
  }
}
