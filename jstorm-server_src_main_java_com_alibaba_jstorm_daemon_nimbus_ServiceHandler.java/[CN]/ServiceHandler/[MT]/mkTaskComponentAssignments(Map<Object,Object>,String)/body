{
  Map<Object,Object> stormConf=StormConfig.read_nimbus_topology_conf(conf,topologyid);
  StormTopology stopology=StormConfig.read_nimbus_topology_code(conf,topologyid);
  Map<Integer,TaskInfo> rtn=new TreeMap<Integer,TaskInfo>();
  StormTopology topology=Common.system_topology(stormConf,stopology);
  Integer count=0;
  count=mkTaskMaker(stormConf,topology.get_bolts(),rtn,count);
  count=mkTaskMaker(stormConf,topology.get_spouts(),rtn,count);
  count=mkTaskMaker(stormConf,topology.get_state_spouts(),rtn,count);
  return rtn;
}
