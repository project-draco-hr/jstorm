{
  _collector=collector;
  _context=context;
  List<Integer> taskIds=_context.getComponentTasks("Mbolt");
  for (int i=0; i < producerNum; i++) {
    Thread thread=new Thread(new ProducerThread(taskIds,producerNum,i,queue));
    thread.start();
  }
  Thread thread=new Thread(new Runnable(){
    @Override public void run(){
      try {
        Thread.sleep(20000);
        while (msgToTask.size() != 0 || !state) {
          Thread.sleep(10000);
          for (          java.util.Map.Entry<Integer,Integer> entry : failToTask.entrySet())           LOG.error("Task " + entry.getKey() + " has fail tuple num "+ entry.getValue());
        }
      }
 catch (      InterruptedException e) {
        e.printStackTrace();
      }
      LOG.info("All work done");
    }
  }
);
  thread.start();
}
