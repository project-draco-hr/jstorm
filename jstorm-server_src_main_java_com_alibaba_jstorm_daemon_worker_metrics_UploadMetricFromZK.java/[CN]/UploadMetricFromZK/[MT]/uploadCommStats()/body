{
  rmObsoleteTopo();
  List<Map<String,Object>> listMapMsg=new ArrayList<Map<String,Object>>();
  try {
    TopoCommStatsInfo ret;
    List<String> topologys=clusterState.heartbeat_storms();
    for (    String topologyId : topologys) {
      if (topologyMap.containsKey(topologyId) == false) {
        StormBase base=clusterState.storm_base(topologyId,null);
        if (base == null) {
          topologyMap.remove(topologyId);
          continue;
        }
 else {
          topologyMap.put(topologyId,new TopoCommStatsInfo(topologyId,base.getStormName()));
        }
      }
      ret=getCommStatsData(topologyId);
      if (ret != null) {
        buildCommStatsData(ret);
        buildComonSendMsg(ret,listMapMsg);
      }
    }
    if (listMapMsg.size() > 0) {
      sendCommStatsData(listMapMsg);
    }
  }
 catch (  Exception e) {
    LOG.warn("Failed to upload comm statistic data to Alimonitor.",e);
  }
}
