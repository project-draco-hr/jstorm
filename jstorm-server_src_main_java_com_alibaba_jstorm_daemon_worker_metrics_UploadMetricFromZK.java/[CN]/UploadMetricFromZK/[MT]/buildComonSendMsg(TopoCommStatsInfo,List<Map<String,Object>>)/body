{
  String topoloygName=commStatsInfo.getTopoName();
  Map<String,Object> jsonMsg;
  try {
    TopoCommStatsInfo.CommStatsData topoStatsData=commStatsInfo.getTopoStatsData();
    jsonMsg=topoStatsData.convertToKVMap(topoloygName,topoloygName);
    listMapMsg.add(jsonMsg);
    Map<String,TopoCommStatsInfo.CommStatsData> spoutStatsData=commStatsInfo.getSpoutStatsData();
    for (    Entry<String,TopoCommStatsInfo.CommStatsData> entry : spoutStatsData.entrySet()) {
      String componentId=entry.getKey();
      jsonMsg=entry.getValue().convertToKVMap(topoloygName,componentId);
      listMapMsg.add(jsonMsg);
    }
    Map<String,TopoCommStatsInfo.CommStatsData> boltStatsData=commStatsInfo.getBoltStatsData();
    for (    Entry<String,TopoCommStatsInfo.CommStatsData> entry : boltStatsData.entrySet()) {
      String componentId=entry.getKey();
      jsonMsg=entry.getValue().convertToKVMap(topoloygName,componentId);
      listMapMsg.add(jsonMsg);
    }
  }
 catch (  Exception e) {
    LOG.warn("Error when bulding common statistic data message.",e);
  }
}
