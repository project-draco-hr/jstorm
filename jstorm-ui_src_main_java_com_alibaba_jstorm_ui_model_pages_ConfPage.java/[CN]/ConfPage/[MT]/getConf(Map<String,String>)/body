{
  NimbusClient client=null;
  try {
    client=NimbusClientManager.getNimbusClient(paramMap);
    String confType=paramMap.get(UIDef.CONF_TYPE);
    if (UIDef.CONF_TYPE_NIMBUS.equals(confType)) {
      String confStr=client.getClient().getNimbusConf();
      return confStr;
    }
 else     if (UIDef.CONF_TYPE_TOPOLOGY.equals(confType)) {
      String topologyId=paramMap.get(UIDef.TOPOLOGY);
      if (topologyId == null) {
        throw new IllegalArgumentException("Invalid parameter, please set topologyId");
      }
      return client.getClient().getTopologyConf(topologyId);
    }
 else     if (UIDef.CONF_TYPE_SUPERVISOR.equals(confType)) {
      return getSupervisorConf(paramMap);
    }
 else {
      throw new IllegalArgumentException("Invalid parameter, please Conf type");
    }
  }
 catch (  Exception e) {
    NimbusClientManager.removeClient(paramMap);
    LOG.error(e.getMessage(),e);
    throw new RuntimeException(e);
  }
}
