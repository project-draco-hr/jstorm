{
  List<String> workerIds=clusterState.monitor_user_workers(topologyId);
  MetricKVMsg topologyMetricMsg=new MetricKVMsg();
  for (  String workerId : workerIds) {
    UserDefMetricData useWorkDefMetric=clusterState.get_userDef_metric(topologyId,workerId);
    topologyMetricMsg.countGangeMetric(useWorkDefMetric.getGaugeDataMap());
    topologyMetricMsg.countCounterMetric(useWorkDefMetric.getCounterDataMap());
    topologyMetricMsg.countHistogramMetric(useWorkDefMetric.getHistogramDataMap());
    topologyMetricMsg.countTimerMetric(useWorkDefMetric.getTimerDataMap());
    topologyMetricMsg.countMeterMetric(useWorkDefMetric.getMeterDataMap());
  }
  topologyMetricMsg.calcAvgTimer();
  topologyMetricMsg.emptyCountMap();
  return topologyMetricMsg;
}
