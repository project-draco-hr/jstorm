{
  Pair trade=PairMaker.makeTradeInstance();
  Pair customer=PairMaker.makeCustomerInstance();
  TradeCustomer tradeCustomer=new TradeCustomer();
  tradeCustomer.setTrade(trade);
  tradeCustomer.setCustomer(customer);
  tradeSum.addAndGet(trade.getValue());
  customerSum.addAndGet(customer.getValue());
  collector.emit(new Values(tupleId,tradeCustomer),Long.valueOf(tupleId));
  tupleId++;
  handleCounter.incrementAndGet();
  while (handleCounter.get() >= MAX_PENDING_COUNTER - 1) {
    try {
      Thread.sleep(1);
    }
 catch (    InterruptedException e) {
    }
  }
  tpsCounter.count();
}
