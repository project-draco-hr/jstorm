{
  LOG.info("Begin to close connection to {} and flush all data, batchQueue {}, disruptor {}",name,batchQueue.size(),disruptorQueue.population());
  sendAllData();
  Metrics.unregister(batchQueueName);
  Metrics.unregister(disruptorQueueName);
  super.close();
  clientChannelFactory.releaseExternalResources();
}
