{
  long start=System.nanoTime();
  try {
    String topologyId=getTopologyId(topologyName);
    if (pos < 0) {
      LOG.warn("Invalid pos {}, set it as 0",pos);
      pos=0;
    }
    SortedMap<String,MetricInfo> allConnections=data.getMetricRunnable().getNettyMetric(topologyId);
    int mapSize=allConnections.size();
    NettyMetric ret=new NettyMetric();
    ret.set_connectionNum(mapSize);
    Map<String,MetricInfo> selectConnections=new TreeMap<String,MetricInfo>();
    ret.set_connections(selectConnections);
    int i=0;
    int selectMapSize=0;
    for (    Entry<String,MetricInfo> entry : allConnections.entrySet()) {
      i++;
      if (i <= pos) {
        continue;
      }
      selectConnections.put(entry.getKey(),entry.getValue());
      selectMapSize++;
      if (selectMapSize >= MetricDef.NETTY_METRICS_PACKAGE_SIZE) {
        break;
      }
    }
    return ret;
  }
  finally {
    double spend=(System.nanoTime() - start) / 1000000.0d;
    SimpleJStormMetric.updateHistorgram("getNettyMetric",spend);
    LOG.info("getNettyMetric, {}:{} ms",topologyName,spend);
  }
}
