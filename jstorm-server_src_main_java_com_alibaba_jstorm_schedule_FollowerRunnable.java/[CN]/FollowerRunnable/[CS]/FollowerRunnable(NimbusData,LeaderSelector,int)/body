{
  this.data=data;
  this.leaderSelector=leaderSelector;
  this.sleepTime=sleepTime;
  try {
    data.getStormClusterState().register_nimbus_host(NetWorkUtils.hostname() + "_pid_" + JStormUtils.process_pid());
  }
 catch (  Exception e) {
    LOG.error("register nimbus host fail!",e);
    throw new RuntimeException();
  }
  callback=new RunnableCallback(){
    @Override public void run(){
      check();
    }
  }
;
}
