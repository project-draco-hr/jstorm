{
  Set<Integer> keepTasks=new HashSet<Integer>();
  for (  ResourceWorkerSlot worker : keepAssignments) {
    for (    Integer taskId : worker.getTasks()) {
      if (tasks.contains(taskId)) {
        ResourceWorkerSlot contextWorker=taskContext.getWorker(worker);
        if (contextWorker != null) {
          String componentName=context.getTaskToComponent().get(taskId);
          updateAssignedTasksOfWorker(taskId,contextWorker);
          updateComponentsNumOfWorker(componentName,contextWorker);
          keepTasks.add(taskId);
        }
      }
    }
  }
  int doneAssignedTaskNum=0;
  while (true) {
    boolean found=false;
    Set<ResourceWorkerSlot> doneAssignedWorkers=new HashSet<ResourceWorkerSlot>();
    for (    ResourceWorkerSlot worker : keepAssignments) {
      ResourceWorkerSlot contextWorker=taskContext.getWorker(worker);
      if (contextWorker != null && isTaskFullForWorker(contextWorker)) {
        found=true;
        workerNum--;
        taskContext.getWorkerToTaskNum().remove(contextWorker);
        assignments.add(contextWorker);
        doneAssignedWorkers.add(worker);
        doneAssignedTaskNum+=contextWorker.getTasks().size();
      }
    }
    if (found) {
      setTaskNum((tasks.size() - doneAssignedTaskNum),workerNum);
      keepAssignments.removeAll(doneAssignedWorkers);
    }
 else {
      break;
    }
  }
  tasks.removeAll(keepTasks);
  LOG.info("keep following assignment, " + assignments);
}
