{
  if (active.get() == false) {
    return;
  }
  try {
    StatusType newTopologyStatus=StatusType.activate;
    StormBase base=zkCluster.storm_base(topologyId,this);
    if (base == null) {
      LOG.warn("Failed to get StromBase from ZK of " + topologyId);
      newTopologyStatus=StatusType.killed;
    }
 else {
      newTopologyStatus=base.getStatus().getStatusType();
    }
    try {
      StormMonitor monitor=zkCluster.get_storm_monitor(topologyId);
      if (null != monitor) {
        boolean newMetricsMonitor=monitor.getMetrics();
        MetricReporter metricReporter=workerData.getMetricsReporter();
        boolean oldMetricsMonitor=metricReporter.isEnable();
        if (oldMetricsMonitor != newMetricsMonitor) {
          metricReporter.setEnable(newMetricsMonitor);
          if (true == newMetricsMonitor) {
            LOG.info("Start metrics reporter");
          }
 else {
            LOG.info("Stop metrics reporter");
          }
        }
      }
    }
 catch (    Exception e) {
      LOG.warn("Failed to get monitor status of topology " + topologyId);
      LOG.debug(e);
    }
    StatusType oldTopologyStatus=workerData.getTopologyStatus();
    if (newTopologyStatus.equals(oldTopologyStatus)) {
      return;
    }
    LOG.info("Old TopologyStatus:" + oldTopologyStatus + ", new TopologyStatus:"+ newTopologyStatus);
    workerData.setTopologyStatus(newTopologyStatus);
    List<TaskShutdownDameon> tasks=workerData.getShutdownTasks();
    if (tasks == null) {
      LOG.info("Tasks aren't ready or begin to shutdown");
      return;
    }
    if (newTopologyStatus.equals(StatusType.active)) {
      for (      TaskShutdownDameon task : tasks) {
        task.active();
      }
    }
 else {
      for (      TaskShutdownDameon task : tasks) {
        task.deactive();
      }
    }
  }
 catch (  Exception e) {
    LOG.error("Failed to get topology from ZK ",e);
    return;
  }
}
